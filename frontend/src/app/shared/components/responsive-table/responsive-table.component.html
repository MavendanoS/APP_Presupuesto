<!-- Loading State -->
@if (loading) {
  <div class="text-center py-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
  </div>
}

<!-- Empty State -->
@else if (!data || data.length === 0) {
  <div class="text-center py-5">
    <i class="bi bi-inbox text-muted" style="font-size: 3rem;"></i>
    <p class="text-muted mt-3">{{ emptyMessage }}</p>
  </div>
}

<!-- Desktop Table -->
@else {
  <div class="table-responsive hide-on-mobile">
    <table class="table table-hover">
      <thead>
        <tr>
          @for (column of columns; track column.key) {
            <th
              [class.sortable]="column.sortable"
              (click)="onSort(column)"
            >
              {{ column.label }}
              @if (column.sortable) {
                <i class="ms-1 {{getSortIcon(column)}}"></i>
              }
            </th>
          }
          @if (actionsTemplate) {
            <th class="text-end">Acciones</th>
          }
        </tr>
      </thead>
      <tbody>
        @for (row of data; track $index) {
          <tr (click)="onRowClick(row)" style="cursor: pointer;">
            @for (column of columns; track column.key) {
              <td>
                <ng-container [ngTemplateOutlet]="actionsTemplate || null"
                              [ngTemplateOutletContext]="{$implicit: row, column: column}">
                  {{ getValue(row, column.key) }}
                </ng-container>
              </td>
            }
            @if (actionsTemplate) {
              <td class="text-end">
                <ng-container [ngTemplateOutlet]="actionsTemplate"
                              [ngTemplateOutletContext]="{$implicit: row}">
                </ng-container>
              </td>
            }
          </tr>
        }
      </tbody>
    </table>
  </div>

  <!-- Mobile Cards -->
  <div class="mobile-cards show-only-mobile">
    @for (row of data; track $index) {
      <div class="card mb-3" (click)="onRowClick(row)">
        <div class="card-body">
          @for (column of columns; track column.key) {
            <div class="mb-2">
              <small class="text-muted d-block">
                {{ column.mobileLabel || column.label }}
              </small>
              <strong>{{ getValue(row, column.key) }}</strong>
            </div>
          }
          @if (actionsTemplate) {
            <div class="mt-3 pt-3 border-top">
              <ng-container [ngTemplateOutlet]="actionsTemplate"
                            [ngTemplateOutletContext]="{$implicit: row}">
              </ng-container>
            </div>
          }
        </div>
      </div>
    }
  </div>
}
